# `kern.log`
The `kern.log` file contains messages generated by the kernel. This log file is part of the system's logging infrastructure. It is used to record kernel messages and events.

- **Kernel Boot Messages**: Information about the kernel and hardware initialization during the boot process.
- **Driver Messages**: Logs related to the loading and unloading of kernel modules and device drivers.
- **Hardware Events**: Notifications about hardware changes, such as connecting or disconnecting USB devices.
    - SATA link connected. 
- **Kernel Errors**: Errors and warnings generated by the kernel, which can be useful for diagnosing system issues.
    - General protection fault
    - Memory allocation failure
    - Disk error
- **Network Activity**: Some network-related events and messages might also be logged here.

![Linux kernel, from Wikipedia](https://upload.wikimedia.org/wikipedia/commons/3/3a/Linux_kernel_ubiquity.svg)


## `kern.log` examples
Disclamer: all code snippets below are pseudo code. 

### Kernel boot message 
```
Jan 1 00:00:00 hostname kernel: [    0.000000] Linux version 5.4.0-42-generic (buildd@lgw01-amd64-046) (gcc version 9.3.0 (Ubuntu 9.3.0-10ubuntu2)) #46-Ubuntu SMP Fri Jul 10 00:24:02 UTC 2020 (Ubuntu 5.4.0-42.46-generic 5.4.44)
Jan 1 00:00:00 hostname kernel: [    0.000000] Command line: BOOT_IMAGE=/boot/vmlinuz-5.4.0-42-generic root=UUID=12345678-1234-1234-1234-123456789abc ro quiet splash
```

### Driver messages
```
Jan 1 00:00:10 hostname kernel: [   10.123456] usb 1-1: new high-speed USB device number 2 using xhci_hcd
Jan 1 00:00:10 hostname kernel: [   10.234567] usb 1-1: New USB device found, idVendor=0781, idProduct=558a, bcdDevice= 1.00
Jan 1 00:00:10 hostname kernel: [   10.234568] usb 1-1: New USB device strings: Mfr=1, Product=2, SerialNumber=3
Jan 1 00:00:10 hostname kernel: [   10.234569] usb 1-1: Product: USB Flash Drive
Jan 1 00:00:10 hostname kernel: [   10.234570] usb 1-1: Manufacturer: SanDisk
```

### Hardware events 
```
Jan 1 00:00:20 hostname kernel: [   20.123456] ata1: SATA link up 6.0 Gbps (SStatus 133 SControl 300)
Jan 1 00:00:
```
- **Kernel Message**: `[ 20.123456] ata1: SATA link up 6.0 Gbps (SStatus 133 SControl 300)`
    - `[ 20.123456]`: Indicates the time since system boot when this message was logged.
    - `ata1`: Refers to the first SATA port (SATA device 1) on the system.
    - `SATA link up 6.0 Gbps`: Indicates that the SATA link has been established at a speed of 6.0 gigabits per second (Gbps). This typically means the SATA device (such as a hard drive or SSD) connected to this port is operating at its maximum supported speed.
    - `(SStatus 133 SControl 300)`: These values provide additional status and control information related to the SATA link. `SStatus` and `SControl` are SATA status and control registers, respectively, which contain various flags and settings related to the device's operation.
- Summary: the SATA link for the device connected to the first SATA port (ata1) has been successfully established at a speed of 6.0 Gbps, as reported by the kernel during system boot.

    ![Expansion cards with 5 SATA ports](https://usb.brando.com/prod_img/zoom/UADAP017900_2.jpg)  
    image from brando.com

### Kernel error
#### General protection fault
```
Jan 1 00:05:00 myhostname kernel: [  300.123456] general protection fault: 0000 [#1] SMP NOPTI
Jan 1 00:05:00 myhostname kernel: [  300.123457] CPU: 1 PID: 1234 Comm: some_process Not tainted 5.4.0-42-generic #46-Ubuntu
Jan 1 00:05:00 myhostname kernel: [  300.123458] Hardware name: Dell Inc. Latitude 5500/0D0T00, BIOS 1.5.0 10/15/2019
Jan 1 00:05:00 myhostname kernel: [  300.123459] RIP: 0010:my_function+0x1f/0x30 [my_module]
Jan 1 00:05:00 myhostname kernel: [  300.123460] Code: 48 89 d8 48 89 c7 e8 10 2f 00 00 5b 5d c3 0f 1f 00 66 90 48 83 ec 08 48 89 d8 48 89 c7
```

#### Memory allocation failure
```
Jan 1 00:10:00 hostname kernel: [  600.654321] some_process: page allocation failure: order:0, mode:0x280000000(GFP_KERNEL)
Jan 1 00:10:00 hostname kernel: [  600.654322] CPU: 0 PID: 5678 Comm: some_process Not tainted 5.4.0-42-generic #46-Ubuntu
Jan 1 00:10:00 hostname kernel: [  600.654323] Hardware name: Example Corp. Example Model/Example Board, BIOS 1.0.0 01/01/2020
Jan 1 00:10:00 hostname kernel: [  600.654324] Call Trace:
Jan 1 00:10:00 hostname kernel: [  600.654325]  dump_stack+0x70/0x90
```

Something went wrong during `some_process`. Shows information about the relevant hardware and the call trace where the error occurred. 
```
Jan 1 00:10:00 myhostname kernel: [  600.654321] some_process: page allocation failure: order:0, mode:0x280000000(GFP_KERNEL)
Jan 1 00:10:00 myhostname kernel: [  600.654322] CPU: 0 PID: 5678 Comm: some_process Not tainted 5.4.0-42-generic #46-Ubuntu
Jan 1 00:10:00 myhostname kernel: [  600.654323] Hardware name: HP ProBook 450 G5/837D, BIOS Q85 Ver. 01.03.00 12/12/2019
Jan 1 00:10:00 myhostname kernel: [  600.654324] Call Trace:
Jan 1 00:10:00 myhostname kernel: [  600.654325]  dump_stack+0x70/0x90
Jan 1 00:10:00 myhostname kernel: [  600.654326]  warn_alloc.cold+0x7b/0xdf
Jan 1 00:10:00 myhostname kernel: [  600.654327]  __alloc_pages_slowpath+0xd54/0xd70
Jan 1 00:10:00 myhostname kernel: [  600.654328]  __alloc_pages_nodemask+0x2d0/0x320
Jan 1 00:10:00 myhostname kernel: [  600.654329]  alloc_pages_current+0x6a/0xe0
Jan 1 00:10:00 myhostname kernel: [  600.654330]  __get_free_pages+0x12/0x40
Jan 1 00:10:00 myhostname kernel: [  600.654331]  proc_pid_cmdline_read+0x3d/0x140
Jan 1 00:10:00 myhostname kernel: [  600.654332]  proc_reg_read+0x44/0x80
Jan 1 00:10:00 myhostname kernel: [  600.654333]  vfs_read+0x91/0x160
Jan 1 00:10:00 myhostname kernel: [  600.654334]  ksys_read+0x55/0xd0
Jan 1 00:10:00 myhostname kernel: [  600.654335]  __x64_sys_read+0x1a/0x20
Jan 1 00:10:00 myhostname kernel: [  600.654336]  do_syscall_64+0x57/0x190
Jan 1 00:10:00 myhostname kernel: [  600.654337]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
Jan 1 00:10:00 myhostname kernel: [  600.654338] RIP: 0033:0x7f8b92b4654e
Jan 1 00:10:00 myhostname kernel: [  600.654339] Code: Bad RIP value.
Jan 1 00:10:00 myhostname kernel: [  600.654340] RSP: 002b:00007ffd8a2ffae8 EFLAGS: 00010246
Jan 1 00:10:00 myhostname kernel: [  600.654341] RAX: ffffffffffffffda RBX: 0000000000000000 RCX: 00007f8b92b4654e
Jan 1 00:10:00 myhostname kernel: [  600.654342] RDX: 0000000000000400 RSI: 000055555555f000 RDI: 0000000000000004
Jan 1 00:10:00 myhostname kernel: [  600.654343] RBP: 000055555555f000 R08: 0000000000000000 R09: 0000000000000000
Jan 1 00:10:00 myhostname kernel: [  600.654344] R10: 00007f8b92b4654e R11: 0000000000000246 R12: 0000000000000400
Jan 1 00:10:00 myhostname kernel: [  600.654345] R13: 000055555555f000 R14: 0000000000000000 R15: 0000000000000000
```

#### Disk error

An error encountered by the `EXT4` file system (`EXT4-fs`) on the device identified as `sda1`.

```
Jan 1 00:15:00 hostname kernel: [  900.789012] EXT4-fs error (device sda1): ext4_find_entry:1463: inode #2: comm some_process: reading directory lblock 0
Jan 1 00:15:00 hostname kernel: [  900.789013] Aborting journal on device sda1-8.
Jan 1 00:15:00 hostname kernel: [  900.789014] EXT4-fs (sda1): Remounting filesystem read-only
```

- `[ 900.789012] EXT4-fs error (device sda1): ext4_find_entry:1463: inode #2: comm some_process: reading directory lblock 0`: This message indicates an error encountered by the EXT4 file system on the device `sda1`. Specifically, it mentions that there was an error while trying to find an entry within a directory `inode` (`ext4_find_entry`), and it occurred at `block 0` of the directory.
- `[ 900.789013] Aborting journal on device sda1-8.`: The kernel is aborting the journaling process (logging changes to the file system) on the device `sda1`. This action is often taken to prevent further potential corruption or data loss.
- `[ 900.789014] EXT4-fs (sda1): Remounting filesystem read-only`: The file system on `sda1` is being remounted as `read-only`. This is a precautionary measure to prevent further writes to the file system, which can help safeguard data integrity in case of file system errors.

### Network activity
#### Network interface up/down

```
Jan 1 00:20:00 hostname kernel: [ 1200.123456] e1000e: eth0 NIC Link is Up 1000 Mbps Full Duplex, Flow Control: Rx/Tx
Jan 1 00:20:00 hostname kernel: [ 1200.123457] IPv6: ADDRCONF(NETDEV_CHANGE): eth0: link becomes ready
Jan 1 00:25:00 hostname kernel: [ 1500.654321] e1000e: eth0 NIC Link is Down
```

#### DHCP events 
```
Jan 1 00:30:00 hostname kernel: [ 1800.123456] dhclient[7890]: DHCPDISCOVER on eth0 to 255.255.255.255 port 67 interval 3
Jan 1 00:30:00 hostname kernel: [ 1800.123457] dhclient[7890]: DHCPOFFER from 192.168.1.1
Jan 1 00:30:00 hostname kernel: [ 1800.123458] dhclient[7890]: DHCPREQUEST on eth0 to 255.255.255.255 port 67
Jan 1 00:30:00 hostname kernel: [ 1800.123459] dhclient[7890]: DHCPACK from 192.168.1.1
```

#### Packet dropped due to firewall 
```
Jan 1 00:35:00 hostname kernel: [ 2100.987654] iptables DROP IN=eth0 OUT= MAC=00:11:22:33:44:55:66:77:88:99 SRC=192.168.1.100 DST=192.168.1.200 LEN=60 TOS=0x00 PREC=0x00 TTL=64 ID=54321 DF PROTO=TCP SPT=12345 DPT=80 WINDOW=65535 RES=0x00 SYN URGP=0 
```

#### Wi-fi events
```
Jan 1 00:40:00 hostname kernel: [ 2400.123456] wlan0: authenticated
Jan 1 00:40:00 hostname kernel: [ 2400.123457] wlan0: associate with 00:11:22:33:44:55 (try 1/3)
Jan 1 00:40:00 hostname kernel: [ 2400.123458] wlan0: RX AssocResp from 00:11:22:33:44:55 (capab=0x411 status=0 aid=1)
Jan 1 00:40:00 hostname kernel: [ 2400.123459] wlan0: associated
```
